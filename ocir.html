<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Obsessive-Compulsive Inventory Revised (OCI-R)</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    :root {
      --primary-blue: #2196F3;
      --secondary-blue: #1976D2;
      --light-blue: #E3F2FD;
      --accent-teal: #009688;
      --accent-orange: #FF9800;
      --accent-red: #F44336;
      --accent-green: #4CAF50;
      --text-dark: #333333;
      --text-light: #666666;
      --border-color: #E0E0E0;
      --card-bg: #FFFFFF;
      --section-bg: #F5F7FA;
      --washing-color: #00BCD4;
      --checking-color: #FF9800;
      --ordering-color: #9C27B0;
      --obsessing-color: #F44336;
      --hoarding-color: #795548;
      --neutralizing-color: #4CAF50;
    }
    
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    
    body {
      background: var(--section-bg);
      color: var(--text-dark);
      line-height: 1.6;
      padding: 20px;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }
    
    /* Header Styles */
    .header {
      background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
      color: white;
      padding: 30px;
      position: relative;
      overflow: hidden;
    }
    
    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--accent-teal);
    }
    
    .header-content {
      max-width: 800px;
      margin: 0 auto;
      text-align: center;
    }
    
    .header h1 {
      font-size: 2.2rem;
      margin-bottom: 10px;
      font-weight: 600;
    }
    
    .header .subtitle {
      font-size: 1.1rem;
      opacity: 0.9;
      margin-bottom: 20px;
    }
    
    .header-badges {
      display: flex;
      justify-content: center;
      gap: 15px;
      flex-wrap: wrap;
      margin-top: 20px;
    }
    
    .badge {
      background: rgba(255, 255, 255, 0.15);
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.85rem;
      display: flex;
      align-items: center;
      gap: 8px;
      backdrop-filter: blur(10px);
    }
    
    /* Patient Information */
    .patient-info {
      padding: 25px;
      border-bottom: 1px solid var(--border-color);
      background: var(--light-blue);
    }
    
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
    }
    
    .info-card {
      display: flex;
      flex-direction: column;
    }
    
    .info-card label {
      font-weight: 600;
      color: var(--secondary-blue);
      margin-bottom: 8px;
      font-size: 0.9rem;
    }
    
    .info-card input,
    .info-card select {
      padding: 12px;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      font-size: 1rem;
      transition: border-color 0.3s;
    }
    
    .info-card input:focus,
    .info-card select:focus {
      outline: none;
      border-color: var(--primary-blue);
    }
    
    /* Instructions */
    .instructions {
      padding: 30px;
      background: var(--card-bg);
      border-bottom: 1px solid var(--border-color);
    }
    
    .instructions h3 {
      color: var(--secondary-blue);
      margin-bottom: 15px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .time-frame {
      background: #FFF8E1;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border-left: 4px solid var(--accent-orange);
    }
    
    .time-frame h4 {
      color: #F57C00;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    /* Response Scale */
    .response-scale {
      background: #E8F5E9;
      padding: 20px;
      border-radius: 10px;
      margin: 20px 0;
      border-left: 4px solid var(--accent-green);
    }
    
    .scale-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 15px;
      margin-top: 15px;
    }
    
    .scale-item {
      text-align: center;
      padding: 15px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    }
    
    .scale-value {
      font-size: 1.8rem;
      font-weight: bold;
      margin-bottom: 5px;
    }
    
    .scale-label {
      font-weight: 600;
      margin-bottom: 5px;
    }
    
    .scale-frequency {
      font-size: 0.85rem;
      color: var(--text-light);
    }
    
    /* Score Display */
    .score-display {
      position: sticky;
      top: 10px;
      background: white;
      padding: 20px;
      margin: 0 30px 30px;
      border-radius: 10px;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      border: 2px solid var(--primary-blue);
      z-index: 100;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
    }
    
    .score-section {
      text-align: center;
      flex: 1;
      min-width: 150px;
    }
    
    .score-label {
      font-size: 0.9rem;
      color: var(--text-light);
      margin-bottom: 5px;
    }
    
    .score-value {
      font-size: 2.5rem;
      font-weight: bold;
      color: var(--primary-blue);
      line-height: 1;
    }
    
    .score-indicator {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      font-size: 0.8rem;
      margin-top: 5px;
      padding: 3px 10px;
      border-radius: 12px;
    }
    
    /* Items Container */
    .items-container {
      padding: 0 30px 30px;
    }
    
    .items-grid {
      display: grid;
      gap: 20px;
    }
    
    .item-card {
      background: var(--card-bg);
      border: 1px solid var(--border-color);
      border-radius: 10px;
      padding: 25px;
      transition: transform 0.2s, box-shadow 0.2s;
      position: relative;
    }
    
    .item-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
    }
    
    .item-card.active {
      border-color: var(--primary-blue);
      box-shadow: 0 4px 12px rgba(33, 150, 243, 0.15);
    }
    
    .item-number {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 36px;
      height: 36px;
      background: var(--light-blue);
      color: var(--primary-blue);
      border-radius: 50%;
      font-weight: bold;
      margin-bottom: 15px;
      border: 2px solid var(--primary-blue);
    }
    
    .item-text {
      font-size: 1.1rem;
      font-weight: 500;
      margin-bottom: 20px;
      line-height: 1.5;
      color: var(--text-dark);
    }
    
    .subscale-label {
      display: inline-block;
      padding: 4px 12px;
      border-radius: 20px;
      color: white;
      font-size: 0.8rem;
      font-weight: 600;
      margin-bottom: 15px;
    }
    
    /* Response Options */
    .response-options {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 10px;
    }
    
    @media (max-width: 992px) {
      .response-options {
        grid-template-columns: repeat(3, 1fr);
      }
    }
    
    @media (max-width: 768px) {
      .response-options {
        grid-template-columns: 1fr;
      }
    }
    
    .response-option {
      position: relative;
    }
    
    .option-btn {
      width: 100%;
      padding: 15px 10px;
      text-align: center;
      border: 2px solid var(--border-color);
      border-radius: 8px;
      background: var(--card-bg);
      color: var(--text-dark);
      cursor: pointer;
      transition: all 0.2s;
      font-size: 0.9rem;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }
    
    .option-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }
    
    .option-btn.selected {
      border-color: var(--primary-blue);
      background: var(--light-blue);
      color: var(--primary-blue);
    }
    
    .option-score {
      font-size: 1.2rem;
      font-weight: bold;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--section-bg);
    }
    
    .option-btn.selected .option-score {
      background: var(--primary-blue);
      color: white;
    }
    
    .option-label {
      font-weight: 600;
      font-size: 0.85rem;
    }
    
    .option-frequency {
      font-size: 0.75rem;
      color: var(--text-light);
      margin-top: 5px;
    }
    
    .option-btn.selected .option-frequency {
      color: var(--primary-blue);
    }
    
    /* Subscales Display */
    .subscales-container {
      padding: 30px;
      background: var(--section-bg);
      border-top: 1px solid var(--border-color);
      display: none;
    }
    
    .subscales-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .subscales-header h3 {
      color: var(--primary-blue);
      margin-bottom: 10px;
    }
    
    .subscales-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
    }
    
    .subscale-card {
      padding: 25px;
      border-radius: 10px;
      background: white;
      box-shadow: 0 3px 10px rgba(0, 0, 0, 0.05);
      text-align: center;
      border-top: 4px solid;
    }
    
    .subscale-title {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 15px;
    }
    
    .subscale-score {
      font-size: 2.5rem;
      font-weight: bold;
      margin: 15px 0;
    }
    
    .subscale-indicator {
      display: inline-flex;
      align-items: center;
      gap: 5px;
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 0.85rem;
      font-weight: 600;
    }
    
    /* Results Section */
    .results-container {
      padding: 30px;
      display: none;
      background: var(--card-bg);
    }
    
    .results-header {
      text-align: center;
      margin-bottom: 30px;
    }
    
    .results-header h2 {
      color: var(--primary-blue);
      margin-bottom: 10px;
    }
    
    .final-scores {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 40px;
    }
    
    .final-score-card {
      padding: 25px;
      border-radius: 10px;
      text-align: center;
      background: linear-gradient(135deg, var(--light-blue), white);
      border: 2px solid var(--primary-blue);
    }
    
    .final-score-value {
      font-size: 3rem;
      font-weight: bold;
      color: var(--primary-blue);
      margin: 10px 0;
    }
    
    .score-interpretation {
      background: var(--light-blue);
      padding: 20px;
      border-radius: 10px;
      margin: 30px 0;
      border-left: 4px solid var(--primary-blue);
    }
    
    /* Controls */
    .controls {
      display: flex;
      justify-content: space-between;
      padding: 25px 30px;
      border-top: 1px solid var(--border-color);
      background: var(--section-bg);
    }
    
    .control-btn {
      padding: 14px 28px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 1rem;
    }
    
    .reset-btn {
      background: var(--light-blue);
      color: var(--primary-blue);
    }
    
    .reset-btn:hover {
      background: #BBDEFB;
    }
    
    .submit-btn {
      background: linear-gradient(135deg, var(--primary-blue), var(--secondary-blue));
      color: white;
    }
    
    .submit-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(33, 150, 243, 0.3);
    }
    
    .print-btn {
      background: linear-gradient(135deg, var(--accent-teal), #00796B);
      color: white;
    }
    
    .print-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 150, 136, 0.3);
    }
    
    /* Footer */
    .footer {
      background: var(--light-blue);
      padding: 25px 30px;
      text-align: center;
      color: var(--text-light);
      font-size: 0.9rem;
      border-top: 1px solid var(--border-color);
    }
    
    .copyright {
      margin-top: 15px;
      padding-top: 15px;
      border-top: 1px solid var(--border-color);
      font-size: 0.8rem;
      color: #999;
    }
    
    /* Responsive Design */
    @media (max-width: 768px) {
      .header h1 {
        font-size: 1.8rem;
      }
      
      .score-display {
        flex-direction: column;
        text-align: center;
        margin: 0 15px 20px;
      }
      
      .controls {
        flex-direction: column;
        gap: 15px;
      }
      
      .control-btn {
        width: 100%;
        justify-content: center;
      }
      
      .items-container {
        padding: 0 15px 20px;
      }
    }
    
    @media print {
      .controls,
      .footer {
        display: none;
      }
      
      .item-card {
        break-inside: avoid;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <div class="header">
      <div class="header-content">
        <h1>Obsessive-Compulsive Inventory Revised (OCI-R)</h1>
        <div class="subtitle">Self-Report Assessment for OCD Symptoms</div>
        
        <div class="header-badges">
          <div class="badge">
            <i class="fas fa-clock"></i>
            <span>5-10 minutes to complete</span>
          </div>
          <div class="badge">
            <i class="fas fa-chart-bar"></i>
            <span>18 items across 6 subscales</span>
          </div>
          <div class="badge">
            <i class="fas fa-calendar-alt"></i>
            <span>Past month assessment</span>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Patient Information -->
    <div class="patient-info">
      <div class="info-grid">
        <div class="info-card">
          <label for="participantName"><i class="fas fa-user"></i> Your Name</label>
          <input type="text" id="participantName" placeholder="Enter your full name">
        </div>
        
        <div class="info-card">
          <label for="assessmentDate"><i class="fas fa-calendar-alt"></i> Assessment Date</label>
          <input type="date" id="assessmentDate" value="<?php echo date('Y-m-d'); ?>">
        </div>
        
        <div class="info-card">
          <label for="clinicianName"><i class="fas fa-user-md"></i> Clinician (Optional)</label>
          <input type="text" id="clinicianName" placeholder="Clinician name">
        </div>
        
        <div class="info-card">
          <label for="referenceNumber"><i class="fas fa-hashtag"></i> Reference Number</label>
          <input type="text" id="referenceNumber" placeholder="Optional reference number">
        </div>
      </div>
    </div>
    
    <!-- Instructions -->
    <div class="instructions">
      <h3><i class="fas fa-info-circle"></i> Instructions</h3>
      <p>The following statements refer to experiences that many people have in their everyday lives. Please select the number that best describes <strong>HOW MUCH that experience has DISTRESSED or BOTHERED you during the PAST MONTH.</strong></p>
      
      <div class="time-frame">
        <h4><i class="fas fa-calendar-check"></i> Time Frame: Past Month</h4>
        <p>Today is <strong><?php echo date('F j, Y'); ?></strong>. One month ago was <strong><?php echo date('F j, Y', strtotime('-1 month')); ?></strong>. Please think about this period when answering.</p>
      </div>
      
      <div class="response-scale">
        <h4><i class="fas fa-ruler"></i> Response Scale</h4>
        <p>The numbers refer to the following verbal labels and approximate frequencies:</p>
        
        <div class="scale-grid">
          <div class="scale-item">
            <div class="scale-value" style="color: #4CAF50;">0</div>
            <div class="scale-label">Not at all</div>
            <div class="scale-frequency">No distress</div>
          </div>
          <div class="scale-item">
            <div class="scale-value" style="color: #8BC34A;">1</div>
            <div class="scale-label">A little</div>
            <div class="scale-frequency">Once per week or less</div>
          </div>
          <div class="scale-item">
            <div class="scale-value" style="color: #FFC107;">2</div>
            <div class="scale-label">Moderately</div>
            <div class="scale-frequency">2-3 times per week</div>
          </div>
          <div class="scale-item">
            <div class="scale-value" style="color: #FF9800;">3</div>
            <div class="scale-label">A lot</div>
            <div class="scale-frequency">4-5 times per week</div>
          </div>
          <div class="scale-item">
            <div class="scale-value" style="color: #F44336;">4</div>
            <div class="scale-label">Extremely</div>
            <div class="scale-frequency">6+ times per week</div>
          </div>
        </div>
      </div>
      
      <p style="margin-top: 20px;"><strong>Important:</strong> There are no right or wrong answers. Do not spend too much time on any one statement. Please answer each question honestly.</p>
    </div>
    
    <!-- Score Display -->
    <div class="score-display" id="scoreDisplay">
      <div class="score-section">
        <div class="score-label">Total OCI-R Score</div>
        <div class="score-value" id="totalScore">0</div>
        <div class="score-label">/72</div>
        <div class="score-indicator" id="totalIndicator" style="background: #E8F5E9; color: #388E3C;">
          <i class="fas fa-circle" style="font-size: 0.6rem;"></i>
          <span>Below clinical threshold</span>
        </div>
      </div>
      
      <div class="score-section">
        <div class="score-label">Mean Distress Score</div>
        <div class="score-value" id="meanScore">0.00</div>
        <div class="score-label">/4.00</div>
      </div>
      
      <div class="score-section">
        <div class="score-label">Clinical Indicator</div>
        <div class="score-value" id="clinicalIndicator">-</div>
        <div class="score-label">Threshold: Total ≥ 18 or Mean ≥ 2.5</div>
      </div>
    </div>
    
    <!-- Items Container -->
    <div class="items-container" id="itemsContainer">
      <div class="items-grid" id="itemsGrid">
        <!-- OCI-R items will be inserted here dynamically -->
      </div>
    </div>
    
    <!-- Subscales Display -->
    <div class="subscales-container" id="subscalesContainer">
      <div class="subscales-header">
        <h3><i class="fas fa-layer-group"></i> OCI-R Subscale Scores</h3>
        <p>Mean scores for each of the 6 subscales (each out of 4.00)</p>
      </div>
      
      <div class="subscales-grid" id="subscalesGrid">
        <!-- Subscale scores will be inserted here dynamically -->
      </div>
    </div>
    
    <!-- Results Section -->
    <div class="results-container" id="resultsContainer">
      <div class="results-header">
        <h2><i class="fas fa-file-medical-alt"></i> OCI-R Assessment Results</h2>
        <p>Obsessive-Compulsive Inventory Revised - Self-Report Assessment</p>
      </div>
      
      <div class="final-scores">
        <div class="final-score-card">
          <div style="font-size: 1.2rem; color: var(--primary-blue); font-weight: 600;">Total OCI-R Score</div>
          <div class="final-score-value" id="finalTotalScore">0</div>
          <div style="color: var(--text-light);">/72</div>
          <div id="finalTotalIndicator" style="margin-top: 10px; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem; background: #E8F5E9; color: #388E3C;">
            Below clinical threshold
          </div>
        </div>
        
        <div class="final-score-card">
          <div style="font-size: 1.2rem; color: var(--accent-teal); font-weight: 600;">Mean Distress Score</div>
          <div class="final-score-value" id="finalMeanScore">0.00</div>
          <div style="color: var(--text-light);">/4.00</div>
          <div id="finalMeanIndicator" style="margin-top: 10px; padding: 5px 10px; border-radius: 15px; font-size: 0.9rem; background: #E8F5E9; color: #388E3C;">
            Below threshold (2.5)
          </div>
        </div>
        
        <div class="final-score-card">
          <div style="font-size: 1.2rem; color: var(--accent-orange); font-weight: 600;">Clinical Significance</div>
          <div id="clinicalSignificance" style="font-size: 2rem; font-weight: bold; color: var(--accent-green); margin: 20px 0;">Negative</div>
          <div style="color: var(--text-light);">Based on OCI-R screening</div>
        </div>
      </div>
      
      <div class="score-interpretation" id="scoreInterpretation">
        <!-- Interpretation will be inserted here dynamically -->
      </div>
      
      <h3 style="color: var(--primary-blue); margin: 30px 0 15px 0;"><i class="fas fa-layer-group"></i> Subscale Analysis</h3>
      <div class="subscales-grid" id="finalSubscalesGrid">
        <!-- Final subscale scores will be inserted here dynamically -->
      </div>
      
      <div class="time-frame" style="margin: 30px 0;">
        <h4><i class="fas fa-exclamation-circle"></i> Clinical Note</h4>
        <p>The OCI-R is a screening tool, not a diagnostic instrument. A total score of 18 or more, or a mean score of 2.5 or more in any of the subscales suggests the possible presence of OCD, but formal diagnosis requires comprehensive clinical evaluation by a qualified mental health professional.</p>
      </div>
    </div>
    
    <!-- Controls -->
    <div class="controls">
      <button class="control-btn reset-btn" onclick="resetAssessment()">
        <i class="fas fa-redo"></i> Reset Assessment
      </button>
      
      <button class="control-btn submit-btn" onclick="submitAssessment()">
        <i class="fas fa-paper-plane"></i> Complete & View Results
      </button>
      
      <button class="control-btn print-btn" onclick="printReport()" style="display: none;" id="printBtn">
        <i class="fas fa-print"></i> Print Report
      </button>
    </div>
    
    <!-- Footer -->
    <div class="footer">
      <p><strong>Obsessive-Compulsive Inventory Revised (OCI-R)</strong></p>
      <p>Developed by Edna B. Foa and colleagues</p>
      
      <div class="copyright">
        <p>Copyright by Edna B. Foa 2002</p>
        <p>This scale should be administered and interpreted by qualified professionals.</p>
      </div>
    </div>
  </div>

  <script>
    // OCI-R Items Data
    const ociItems = [
      {
        id: 1,
        text: "I have saved up so many things that they get in the way.",
        subscale: "Hoarding",
        color: "#795548"
      },
      {
        id: 2,
        text: "I check things more often than necessary.",
        subscale: "Checking",
        color: "#FF9800"
      },
      {
        id: 3,
        text: "I get upset if objects are not arranged properly.",
        subscale: "Ordering",
        color: "#9C27B0"
      },
      {
        id: 4,
        text: "I feel compelled to count while I am doing things.",
        subscale: "Neutralizing",
        color: "#4CAF50"
      },
      {
        id: 5,
        text: "I find it difficult to touch an object when I know it has been touched by strangers or certain people.",
        subscale: "Washing",
        color: "#00BCD4"
      },
      {
        id: 6,
        text: "I find it difficult to control my own thoughts.",
        subscale: "Obsessing",
        color: "#F44336"
      },
      {
        id: 7,
        text: "I collect things I don't need.",
        subscale: "Hoarding",
        color: "#795548"
      },
      {
        id: 8,
        text: "I repeatedly check doors, windows, drawers, etc.",
        subscale: "Checking",
        color: "#FF9800"
      },
      {
        id: 9,
        text: "I get upset if others change the way I have arranged things.",
        subscale: "Ordering",
        color: "#9C27B0"
      },
      {
        id: 10,
        text: "I feel I have to repeat certain numbers.",
        subscale: "Neutralizing",
        color: "#4CAF50"
      },
      {
        id: 11,
        text: "I sometimes have to wash or clean myself simply because I feel contaminated.",
        subscale: "Washing",
        color: "#00BCD4"
      },
      {
        id: 12,
        text: "I am upset by unpleasant thoughts that come into my mind against my will.",
        subscale: "Obsessing",
        color: "#F44336"
      },
      {
        id: 13,
        text: "I avoid throwing things away because I am afraid I might need them later.",
        subscale: "Hoarding",
        color: "#795548"
      },
      {
        id: 14,
        text: "I repeatedly check gas and water taps and light switches after turning them off.",
        subscale: "Checking",
        color: "#FF9800"
      },
      {
        id: 15,
        text: "I need things to be arranged in a particular order.",
        subscale: "Ordering",
        color: "#9C27B0"
      },
      {
        id: 16,
        text: "I feel that there are good and bad numbers.",
        subscale: "Neutralizing",
        color: "#4CAF50"
      },
      {
        id: 17,
        text: "I wash my hands more often and longer than necessary.",
        subscale: "Washing",
        color: "#00BCD4"
      },
      {
        id: 18,
        text: "I frequently get nasty thoughts and have difficulty in getting rid of them.",
        subscale: "Obsessing",
        color: "#F44336"
      }
    ];

    // Subscale definitions
    const subscales = {
      "Washing": { items: [5, 11, 17], description: "Concerns about contamination and excessive washing/cleaning" },
      "Checking": { items: [2, 8, 14], description: "Checking behaviors (doors, appliances, etc.)" },
      "Ordering": { items: [3, 9, 15], description: "Need for order, symmetry, and arrangement" },
      "Obsessing": { items: [6, 12, 18], description: "Obsessional thoughts and difficulty controlling thoughts" },
      "Hoarding": { items: [1, 7, 13], description: "Difficulty discarding and excessive saving of items" },
      "Neutralizing": { items: [4, 10, 16], description: "Mental rituals, counting, and neutralizing behaviors" }
    };

    // Response options
    const responseOptions = [
      { value: 0, label: "Not at all", frequency: "No distress" },
      { value: 1, label: "A little", frequency: "Once/week or less" },
      { value: 2, label: "Moderately", frequency: "2-3 times/week" },
      { value: 3, label: "A lot", frequency: "4-5 times/week" },
      { value: 4, label: "Extremely", frequency: "6+ times/week" }
    ];

    // User responses
    let userResponses = new Array(ociItems.length).fill(null);

    // Initialize the assessment
    document.addEventListener('DOMContentLoaded', function() {
      renderItems();
      updateScoreDisplay();
      
      // Set today's date
      document.getElementById('assessmentDate').valueAsDate = new Date();
      
      // Auto-save data
      document.getElementById('participantName').addEventListener('input', saveFormData);
      
      // Load saved data
      loadFormData();
    });

    // Render all items
    function renderItems() {
      const container = document.getElementById('itemsGrid');
      let html = '';
      
      ociItems.forEach((item, index) => {
        html += `
          <div class="item-card" id="item-${index}">
            <div class="item-number">${item.id}</div>
            <div class="subscale-label" style="background: ${item.color};">${item.subscale}</div>
            <div class="item-text">${item.text}</div>
            
            <div class="response-options">
              ${responseOptions.map((option, optIndex) => `
                <div class="response-option">
                  <button class="option-btn ${userResponses[index] === option.value ? 'selected' : ''}"
                          onclick="selectResponse(${index}, ${option.value})"
                          data-value="${option.value}">
                    <div class="option-score">${option.value}</div>
                    <div class="option-label">${option.label}</div>
                    <div class="option-frequency">${option.frequency}</div>
                  </button>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      });
      
      container.innerHTML = html;
    }

    // Select a response
    function selectResponse(itemIndex, value) {
      userResponses[itemIndex] = value;
      
      // Update UI
      const itemCard = document.getElementById(`item-${itemIndex}`);
      const buttons = itemCard.querySelectorAll('.option-btn');
      buttons.forEach(btn => {
        const btnValue = parseInt(btn.getAttribute('data-value'));
        btn.classList.toggle('selected', btnValue === value);
      });
      
      updateScoreDisplay();
      saveFormData();
      
      // Auto-scroll to next item if not last item
      if (itemIndex < ociItems.length - 1) {
        setTimeout(() => {
          const nextItem = document.getElementById(`item-${itemIndex + 1}`);
          nextItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 300);
      }
    }

    // Calculate scores
    function calculateScores() {
      let totalScore = 0;
      let validResponses = 0;
      
      // Calculate total score
      userResponses.forEach(response => {
        if (response !== null) {
          totalScore += response;
          validResponses++;
        }
      });
      
      // Calculate mean score (rounded to 2 decimals)
      const meanScore = validResponses > 0 ? (totalScore / 18).toFixed(2) : 0;
      
      // Calculate subscale scores
      const subscaleScores = {};
      for (const [subscale, data] of Object.entries(subscales)) {
        let subscaleTotal = 0;
        let subscaleCount = 0;
        
        data.items.forEach(itemId => {
          const itemIndex = itemId - 1; // Convert to zero-based index
          if (userResponses[itemIndex] !== null) {
            subscaleTotal += userResponses[itemIndex];
            subscaleCount++;
          }
        });
        
        const subscaleMean = subscaleCount > 0 ? (subscaleTotal / 3).toFixed(2) : 0;
        subscaleScores[subscale] = {
          total: subscaleTotal,
          mean: parseFloat(subscaleMean),
          items: data.items,
          description: data.description,
          color: ociItems.find(item => item.subscale === subscale).color
        };
      }
      
      // Check clinical significance
      const totalScoreThreshold = totalScore >= 18;
      const meanScoreThreshold = parseFloat(meanScore) >= 2.5;
      const subscaleThreshold = Object.values(subscaleScores).some(score => score.mean >= 2.5);
      
      const clinicallySignificant = totalScoreThreshold || meanScoreThreshold || subscaleThreshold;
      
      return {
        totalScore,
        meanScore: parseFloat(meanScore),
        subscaleScores,
        clinicallySignificant,
        totalScoreThreshold,
        meanScoreThreshold,
        subscaleThreshold
      };
    }

    // Update score display
    function updateScoreDisplay() {
      const scores = calculateScores();
      
      document.getElementById('totalScore').textContent = scores.totalScore;
      document.getElementById('meanScore').textContent = scores.meanScore.toFixed(2);
      
      // Update clinical indicator
      const clinicalIndicator = document.getElementById('clinicalIndicator');
      const totalIndicator = document.getElementById('totalIndicator');
      
      if (scores.clinicallySignificant) {
        clinicalIndicator.textContent = "POSITIVE";
        clinicalIndicator.style.color = "#F44336";
        clinicalIndicator.style.fontWeight = "bold";
        
        totalIndicator.innerHTML = '<i class="fas fa-circle" style="font-size: 0.6rem;"></i><span>Above clinical threshold</span>';
        totalIndicator.style.background = "#FFEBEE";
        totalIndicator.style.color = "#C62828";
      } else {
        clinicalIndicator.textContent = "NEGATIVE";
        clinicalIndicator.style.color = "#4CAF50";
        clinicalIndicator.style.fontWeight = "bold";
        
        totalIndicator.innerHTML = '<i class="fas fa-circle" style="font-size: 0.6rem;"></i><span>Below clinical threshold</span>';
        totalIndicator.style.background = "#E8F5E9";
        totalIndicator.style.color = "#388E3C";
      }
      
      // Update subscales display if available
      updateSubscalesDisplay(scores.subscaleScores);
    }

    // Update subscales display
    function updateSubscalesDisplay(subscaleScores) {
      const container = document.getElementById('subscalesGrid');
      let html = '';
      
      for (const [subscale, data] of Object.entries(subscaleScores)) {
        const isAboveThreshold = data.mean >= 2.5;
        
        html += `
          <div class="subscale-card" style="border-top-color: ${data.color};">
            <div class="subscale-title" style="color: ${data.color};">${subscale}</div>
            <div class="subscale-score" style="color: ${data.color};">${data.mean}</div>
            <div style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 10px;">
              ${data.description}
            </div>
            <div class="subscale-indicator" style="background: ${isAboveThreshold ? '#FFEBEE' : '#E8F5E9'}; color: ${isAboveThreshold ? '#C62828' : '#388E3C'};">
              <i class="fas fa-${isAboveThreshold ? 'exclamation-circle' : 'check-circle'}" style="font-size: 0.8rem;"></i>
              <span>${isAboveThreshold ? 'Above threshold' : 'Below threshold'}</span>
            </div>
          </div>
        `;
      }
      
      container.innerHTML = html;
      
      // Show subscales container if at least one item is answered
      const answeredItems = userResponses.filter(r => r !== null).length;
      document.getElementById('subscalesContainer').style.display = answeredItems > 0 ? 'block' : 'none';
    }

    // Submit assessment
    function submitAssessment() {
      const participantName = document.getElementById('participantName').value.trim();
      
      if (!participantName) {
        alert("Please enter your name before submitting the assessment.");
        document.getElementById('participantName').focus();
        return;
      }
      
      // Check if all items are answered
      const unansweredItems = userResponses.filter(r => r === null).length;
      
      if (unansweredItems > 0) {
        if (!confirm(`You have ${unansweredItems} unanswered questions. Would you like to submit anyway?`)) {
          return;
        }
      }
      
      const scores = calculateScores();
      
      // Update final results display
      document.getElementById('finalTotalScore').textContent = scores.totalScore;
      document.getElementById('finalMeanScore').textContent = scores.meanScore.toFixed(2);
      
      // Update clinical significance
      const clinicalSignificance = document.getElementById('clinicalSignificance');
      const finalTotalIndicator = document.getElementById('finalTotalIndicator');
      const finalMeanIndicator = document.getElementById('finalMeanIndicator');
      
      if (scores.clinicallySignificant) {
        clinicalSignificance.textContent = "POSITIVE";
        clinicalSignificance.style.color = "#F44336";
        
        finalTotalIndicator.innerHTML = 'Above clinical threshold';
        finalTotalIndicator.style.background = "#FFEBEE";
        finalTotalIndicator.style.color = "#C62828";
        
        finalMeanIndicator.innerHTML = scores.meanScoreThreshold ? 'Above threshold (2.5)' : 'Below threshold (2.5)';
        finalMeanIndicator.style.background = scores.meanScoreThreshold ? "#FFEBEE" : "#E8F5E9";
        finalMeanIndicator.style.color = scores.meanScoreThreshold ? "#C62828" : "#388E3C";
      } else {
        clinicalSignificance.textContent = "NEGATIVE";
        clinicalSignificance.style.color = "#4CAF50";
        
        finalTotalIndicator.innerHTML = 'Below clinical threshold';
        finalTotalIndicator.style.background = "#E8F5E9";
        finalTotalIndicator.style.color = "#388E3C";
        
        finalMeanIndicator.innerHTML = 'Below threshold (2.5)';
        finalMeanIndicator.style.background = "#E8F5E9";
        finalMeanIndicator.style.color = "#388E3C";
      }
      
      // Update interpretation
      updateInterpretation(scores);
      
      // Update final subscales display
      updateFinalSubscalesDisplay(scores.subscaleScores);
      
      // Show results and hide assessment
      document.getElementById('itemsContainer').style.display = 'none';
      document.getElementById('subscalesContainer').style.display = 'none';
      document.getElementById('scoreDisplay').style.display = 'none';
      document.getElementById('resultsContainer').style.display = 'block';
      document.getElementById('printBtn').style.display = 'flex';
      
      // Scroll to top
      window.scrollTo(0, 0);
      
      // Save results
      saveAssessmentResults(participantName, scores);
    }

    // Update interpretation
    function updateInterpretation(scores) {
      const container = document.getElementById('scoreInterpretation');
      
      let interpretation = '';
      let recommendations = [];
      
      if (scores.clinicallySignificant) {
        interpretation = `
          <h4 style="color: #F44336; margin-bottom: 15px;">
            <i class="fas fa-exclamation-triangle"></i> Clinical Screening: POSITIVE
          </h4>
          <p>Your OCI-R score suggests possible obsessive-compulsive symptoms that may warrant further evaluation.</p>
          <div style="margin-top: 15px; padding: 15px; background: white; border-radius: 8px;">
            <strong>Total OCI-R Score:</strong> ${scores.totalScore}/72 (threshold: 18)<br>
            <strong>Mean Distress Score:</strong> ${scores.meanScore.toFixed(2)}/4.00 (threshold: 2.5)<br>
            <strong>Assessment Date:</strong> ${new Date().toLocaleDateString()}
          </div>
        `;
        
        recommendations = [
          "Consider comprehensive clinical evaluation by a mental health professional",
          "Discuss these results with your healthcare provider",
          "Explore evidence-based treatments such as Cognitive Behavioral Therapy (CBT) with Exposure and Response Prevention (ERP)",
          "Consider consultation with a specialist in anxiety disorders"
        ];
      } else {
        interpretation = `
          <h4 style="color: #4CAF50; margin-bottom: 15px;">
            <i class="fas fa-check-circle"></i> Clinical Screening: NEGATIVE
          </h4>
          <p>Your OCI-R score suggests minimal obsessive-compulsive symptoms at this time.</p>
          <div style="margin-top: 15px; padding: 15px; background: white; border-radius: 8px;">
            <strong>Total OCI-R Score:</strong> ${scores.totalScore}/72 (threshold: 18)<br>
            <strong>Mean Distress Score:</strong> ${scores.meanScore.toFixed(2)}/4.00 (threshold: 2.5)<br>
            <strong>Assessment Date:</strong> ${new Date().toLocaleDateString()}
          </div>
        `;
        
        recommendations = [
          "Continue routine monitoring of symptoms",
          "Consider periodic re-assessment if experiencing increased distress",
          "Practice stress management and healthy coping strategies",
          "Seek evaluation if symptoms worsen or cause functional impairment"
        ];
      }
      
      // Add subscale-specific notes if any subscale is above threshold
      const elevatedSubscales = Object.entries(scores.subscaleScores)
        .filter(([_, data]) => data.mean >= 2.5)
        .map(([subscale, data]) => subscale);
      
      if (elevatedSubscales.length > 0) {
        interpretation += `
          <div style="margin-top: 15px; padding: 15px; background: #FFF8E1; border-radius: 8px; border-left: 4px solid #FF9800;">
            <strong><i class="fas fa-chart-line"></i> Elevated Subscales:</strong> ${elevatedSubscales.join(', ')}<br>
            <em>These specific symptom areas showed higher distress levels and may be important to address in treatment.</em>
          </div>
        `;
      }
      
      // Add recommendations
      interpretation += `
        <div style="margin-top: 20px;">
          <h5 style="color: var(--primary-blue); margin-bottom: 10px;"><i class="fas fa-heartbeat"></i> Recommendations</h5>
          <ul style="margin-left: 20px;">
            ${recommendations.map(rec => `<li>${rec}</li>`).join('')}
          </ul>
        </div>
      `;
      
      container.innerHTML = interpretation;
    }

    // Update final subscales display
    function updateFinalSubscalesDisplay(subscaleScores) {
      const container = document.getElementById('finalSubscalesGrid');
      let html = '';
      
      for (const [subscale, data] of Object.entries(subscaleScores)) {
        const isAboveThreshold = data.mean >= 2.5;
        
        html += `
          <div class="subscale-card" style="border-top-color: ${data.color};">
            <div class="subscale-title" style="color: ${data.color};">${subscale}</div>
            <div class="subscale-score" style="color: ${data.color};">${data.mean}</div>
            <div style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 10px;">
              Items: ${data.items.join(', ')}
            </div>
            <div class="subscale-indicator" style="background: ${isAboveThreshold ? '#FFEBEE' : '#E8F5E9'}; color: ${isAboveThreshold ? '#C62828' : '#388E3C'};">
              <i class="fas fa-${isAboveThreshold ? 'exclamation-circle' : 'check-circle'}" style="font-size: 0.8rem;"></i>
              <span>${data.mean}/4.00 ${isAboveThreshold ? ' (≥ 2.5)' : ' (< 2.5)'}</span>
            </div>
          </div>
        `;
      }
      
      container.innerHTML = html;
    }

    // Save assessment results
    function saveAssessmentResults(participantName, scores) {
      const assessmentData = {
        test: "Obsessive-Compulsive Inventory Revised (OCI-R)",
        date: new Date().toISOString(),
        participantName: participantName,
        clinicianName: document.getElementById('clinicianName').value,
        referenceNumber: document.getElementById('referenceNumber').value,
        scores: scores,
        responses: ociItems.map((item, index) => ({
          id: item.id,
          text: item.text,
          subscale: item.subscale,
          score: userResponses[index] !== null ? userResponses[index] : null,
          response: userResponses[index] !== null ? responseOptions[userResponses[index]].label : 'Not answered'
        })),
        interpretation: {
          clinicallySignificant: scores.clinicallySignificant,
          totalScore: scores.totalScore,
          meanScore: scores.meanScore,
          elevatedSubscales: Object.entries(scores.subscaleScores)
            .filter(([_, data]) => data.mean >= 2.5)
            .map(([subscale, _]) => subscale)
        }
      };
      
      // Save to localStorage
      const assessments = JSON.parse(localStorage.getItem('ociAssessments') || '[]');
      assessments.push(assessmentData);
      localStorage.setItem('ociAssessments', JSON.stringify(assessments));
    }

    // Save form data
    function saveFormData() {
      const formData = {
        participantName: document.getElementById('participantName').value,
        clinicianName: document.getElementById('clinicianName').value,
        referenceNumber: document.getElementById('referenceNumber').value,
        responses: userResponses
      };
      
      localStorage.setItem('ociFormData', JSON.stringify(formData));
    }

    // Load form data
    function loadFormData() {
      const savedData = localStorage.getItem('ociFormData');
      if (savedData) {
        try {
          const formData = JSON.parse(savedData);
          
          document.getElementById('participantName').value = formData.participantName || '';
          document.getElementById('clinicianName').value = formData.clinicianName || '';
          document.getElementById('referenceNumber').value = formData.referenceNumber || '';
          
          if (formData.responses) {
            userResponses = formData.responses;
            renderItems();
            updateScoreDisplay();
          }
        } catch (e) {
          console.log('Could not load saved data:', e);
        }
      }
    }

    // Reset assessment
    function resetAssessment() {
      if (confirm("Are you sure you want to reset all responses? This action cannot be undone.")) {
        userResponses = new Array(ociItems.length).fill(null);
        
        document.getElementById('participantName').value = '';
        document.getElementById('clinicianName').value = '';
        document.getElementById('referenceNumber').value = '';
        
        renderItems();
        updateScoreDisplay();
        
        // Show assessment and hide results
        document.getElementById('itemsContainer').style.display = 'block';
        document.getElementById('scoreDisplay').style.display = 'flex';
        document.getElementById('resultsContainer').style.display = 'none';
        document.getElementById('printBtn').style.display = 'none';
        
        // Clear saved form data
        localStorage.removeItem('ociFormData');
      }
    }

    // Print report
    function printReport() {
      const printContent = document.getElementById('resultsContainer').innerHTML;
      const originalContent = document.body.innerHTML;
      const participantName = document.getElementById('participantName').value || "Participant";
      const assessmentDate = document.getElementById('assessmentDate').value;
      
      document.body.innerHTML = `
        <div style="padding: 30px; font-family: Arial, sans-serif;">
          <h1 style="color: #2196F3; border-bottom: 2px solid #2196F3; padding-bottom: 10px;">
            OCI-R Assessment Report
          </h1>
          <div style="margin: 20px 0; padding: 15px; background: #E3F2FD; border-radius: 8px;">
            <strong>Participant:</strong> ${participantName}<br>
            <strong>Assessment Date:</strong> ${assessmentDate}<br>
            <strong>Clinician:</strong> ${document.getElementById('clinicianName').value || 'Not specified'}<br>
            <strong>Report Date:</strong> ${new Date().toLocaleDateString()}
          </div>
          ${printContent}
          <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ccc; font-size: 0.8rem; color: #666;">
            <p><strong>Disclaimer:</strong> The Obsessive-Compulsive Inventory Revised (OCI-R) is a screening tool developed by Edna B. Foa. It is not a diagnostic instrument. Formal diagnosis should be made by a qualified mental health professional based on comprehensive clinical evaluation.</p>
            <p style="margin-top: 10px;">Copyright by Edna B. Foa 2002</p>
          </div>
        </div>
      `;
      
      window.print();
      document.body.innerHTML = originalContent;
      location.reload();
    }

    // Keyboard navigation
    document.addEventListener('keydown', function(event) {
      // Number keys 0-4 for response selection
      if (event.key >= '0' && event.key <= '4') {
        event.preventDefault();
        const value = parseInt(event.key);
        
        // Find the currently focused question
        const activeElement = document.activeElement;
        if (activeElement && activeElement.classList.contains('option-btn')) {
          // Get the item index from the button's parent
          const itemCard = activeElement.closest('.item-card');
          if (itemCard) {
            const itemId = itemCard.id.replace('item-', '');
            const itemIndex = parseInt(itemId);
            selectResponse(itemIndex, value);
          }
        }
      }
      
      // Enter key to submit when on last item
      if (event.key === 'Enter' && document.activeElement && 
          document.activeElement.closest('.item-card') && 
          document.activeElement.closest('.item-card').id === 'item-17') {
        event.preventDefault();
        submitAssessment();
      }
    });
  </script>
</body>
</html>